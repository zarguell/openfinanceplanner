---
phase: 06-validation-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - eslint.config.js
  - README.md
  - CLAUDE.md
  - .planning/PROJECT.md
autonomous: true
must_haves:
  truths:
    - "All 308+ tests pass without failures"
    - "ESLint reports zero errors"
    - "Application loads in browser and runs without console errors"
    - "User can create and save financial plan"
    - "Calculations (tax, RMD, projections) produce accurate results"
    - "Documentation reflects current architecture"
  artifacts:
    - path: "eslint.config.js"
      provides: "ESLint configuration with browser globals"
      contains: "browser environment globals"
    - path: "README.md"
      provides: "Project documentation"
      min_lines: 50
    - path: "CLAUDE.md"
      provides: "AI assistant documentation"
      min_lines: 80
    - path: ".planning/PROJECT.md"
      provides: "Project tracking document"
      contains: "Phase 6 marked complete"
  key_links:
    - from: "eslint.config.js"
      to: "src/ui/**/*.js"
      via: "globals configuration"
      pattern: "browser.*globals"
---

<objective>
Fix ESLint configuration to support browser environment and update project documentation to reflect the refactored architecture.

Purpose: Complete the maintainability overhaul by resolving the deferred ESLint issues from Phase 1, ensuring all tooling works correctly, and documenting the final state.

Output: Clean ESLint run with zero errors and current documentation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-test-migration/05-03-SUMMARY.md
@eslint.config.js
@README.md
@CLAUDE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix ESLint configuration for browser environment</name>
  <files>eslint.config.js</files>
  <action>
    Update the ESLint flat config to include browser globals for UI files. The current configuration has Node.js globals but is missing browser environment globals (document, window, alert, etc.).

    1. Import globals from @eslint/js:
       ```js
       import globals from "globals";
       ```

    2. Update the files configuration to use browser globals for UI files:
       ```js
       {
         files: ["src/ui/**/*.js"],
         languageOptions: {
           globals: {
             ...globals.browser,
           }
         }
       }
       ```

    This resolves the 193 ESLint errors in UI files while maintaining Node.js globals for test files.

    Do NOT change any UI code - only the ESLint configuration.
  </action>
  <verify>
    npm run lint returns "0 problems" or only warnings
  </verify>
  <done>ESLint passes with zero errors, all UI files lint successfully</done>
</task>

<task type="auto">
  <name>Task 2: Run full test suite and verify all pass</name>
  <files></files>
  <action>
    Execute the complete test suite to ensure all functionality works correctly after all refactoring:

    1. Run all tests: `npm run test`
    2. Run tests with coverage: `npm run test:coverage`
    3. Verify all 308+ tests pass
    4. Check coverage meets 50% threshold
    5. Note any test failures or coverage drops

    If tests fail, investigate and fix the issues. Test failures indicate broken functionality from refactoring.
  </action>
  <verify>
    npm run test exits with code 0, all tests pass
  </verify>
  <done>All tests pass, coverage at or above 50%</done>
</task>

<task type="auto">
  <name>Task 3: Update README.md with current architecture</name>
  <files>README.md</files>
  <action>
    Update README.md to reflect the refactored architecture and new tooling:

    1. Update the Architecture section to describe the modular structure:
       - Tax calculations split into federal, state, and config modules
       - UI controllers split into PlanController, AccountController, ExpenseIncomeController, ProjectionController
       - Configuration centralized in config/ directory
       - Testing migrated to Vitest framework

    2. Update Development section:
       - Add `npm run test` command
       - Add `npm run lint` command (with ESLint 9 flat config)
       - Add `npm run format` command
       - Add coverage reporting with `npm run test:coverage`
       - Mention GitHub Actions CI workflow

    3. Update Project Status:
       - Note that maintainability overhaul is complete
       - List all 6 phases as completed
       - Highlight: modular architecture, centralized config, modern tooling

    4. Keep the existing Quick Start and Features sections (they're accurate)

    Maintain README's clear, concise tone. Focus on what changed and how to use the new tooling.
  </action>
  <verify>README.md accurately describes current architecture and tooling</verify>
  <done>README.md is current and accurate</done>
</task>

<task type="auto">
  <name>Task 4: Update CLAUDE.md with final architecture</name>
  <files>CLAUDE.md</files>
  <action>
    Update CLAUDE.md to document the final refactored state for future AI assistant sessions:

    1. Add Phase 6 to the Development History section:
       - Phase 6: Validation & Polish (completed 2026-01-17)
       - ESLint browser environment configuration
       - Final documentation updates
       - All functionality verified working

    2. Update the Architecture section:
       - Document the modular tax calculation structure (federal, state, config)
       - Document the extracted UI controllers (4 controllers + coordinator)
       - Document the centralized configuration system (loader + accessor functions)
       - Note that all monolithic files have been split

    3. Update the Testing section:
       - Document Vitest framework (not custom runner)
       - Include coverage reporting (currently ~57%)
       - Note ESLint configuration with browser globals
       - Mention CI workflow enforcement

    4. Update Key Principles:
       - Add principle #7: "Test first, refactor second" (lessons from migration)
       - Update principle #6 to reflect completed config centralization

    5. Update the Current Challenges section:
       - Remove completed items (monolithic files, hardcoded values, no tooling)
       - Note that major maintainability issues are resolved
       - Add: "Increase test coverage in storage and UI modules" (optional future work)

    Ensure CLAUDE.md remains the definitive reference for AI assistants working on this codebase.
  </action>
  <verify>CLAUDE.md accurately describes final architecture and provides complete context</verify>
  <done>CLAUDE.md is comprehensive and current</done>
</task>

<task type="auto">
  <name>Task 5: Update PROJECT.md with Phase 6 completion</name>
  <files>.planning/PROJECT.md</files>
  <action>
    Update .planning/PROJECT.md to mark Phase 6 complete and summarize the maintainability overhaul:

    1. Mark Phase 6 as complete in the Active Requirements table:
       - Add checkmark: "✓ Split monolithic files into focused modules"
       - Add checkmark: "✓ Extract hardcoded values to centralized configuration"
       - Add checkmark: "✓ Add ESLint for code quality enforcement"
       - Add checkmark: "✓ Add Prettier for consistent formatting"
       - Add checkmark: "✓ Add Vitest testing framework"
       - Add checkmark: "✓ Migrate existing custom tests to Vitest"
       - Add checkmark: "✓ Maintain backward compatibility with localStorage schema"

    2. Update the Key Decisions table:
       - Change Split files first, then extracts: ✓ Complete (successful approach)
       - Change Extract config before refactoring: ✓ Complete (enabled smoother refactoring)
       - Change Use Vitest: ✓ Complete (works well with ES6 modules)
       - Change Maintain localStorage schema: ✓ Complete (no breaking changes)

    3. Update the Last Updated date at bottom to 2026-01-17

    4. Add a brief completion note in the Context section:
       "Maintainability overhaul completed (Phase 1-6, 2026-01-17). Codebase is now modular, well-configured, and equipped with modern tooling."
  </action>
  <verify>PROJECT.md reflects Phase 6 completion and all requirements met</verify>
  <done>PROJECT.md marks maintainability overhaul as complete</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run lint` returns 0 errors (may have warnings)
- [ ] `npm run test` passes all 308+ tests
- [ ] `npm run test:coverage` meets 50% threshold
- [ ] README.md accurately describes current state
- [ ] CLAUDE.md documents final architecture
- [ ] PROJECT.md updated with Phase 6 completion
</verification>

<success_criteria>

- ESLint configuration fixed with browser globals
- All tests pass (unit + integration)
- Documentation updated to reflect refactored architecture
- PROJECT.md marks maintainability overhaul as complete
- No new bugs introduced
</success_criteria>

<output>
After completion, create `.planning/phases/06-validation-polish/06-01-SUMMARY.md`
</output>
