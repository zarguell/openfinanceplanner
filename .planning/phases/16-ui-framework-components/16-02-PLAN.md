---
phase: 16-ui-framework-components
plan: 02
type: execute
wave: 2
depends_on: ["16-01"]
files_modified:
  - src/components/forms/ProfileForm.tsx
  - src/components/forms/index.ts
  - src/App.tsx
autonomous: true

must_haves:
  truths:
    - "User can input age, savings, spending, and growth rate values"
    - "Form validation shows clear error messages for invalid inputs"
    - "Numeric fields trigger mobile number keyboard (inputMode='numeric')"
    - "Values persist to Zustand store on form submission"
  artifacts:
    - path: "src/components/forms/ProfileForm.tsx"
      provides: "Financial profile input form with validation"
      exports: ["ProfileForm"]
      min_lines: 60
    - path: "src/components/forms/index.ts"
      provides: "Form component barrel exports"
      exports: ["ProfileForm"]
  key_links:
    - from: "src/components/forms/ProfileForm.tsx"
      to: "@/store"
      via: "useStore hook for state management"
      pattern: "useStore.*setProfile"
    - from: "src/components/forms/ProfileForm.tsx"
      to: "@mantine/form"
      via: "useForm for validation"
      pattern: "useForm.*validate.*getInputProps"
    - from: "src/components/forms/ProfileForm.tsx"
      to: "@/core/types"
      via: "UserProfile type import"
      pattern: "UserProfile"
---

<objective>
Build a financial profile input form using @mantine/form with validation, numeric input handling with mobile keyboard support, and Zustand store integration.

Purpose: Provide users with a validated form to input their financial data (age, savings, spending, growth rate) that integrates with the existing Zustand store.

Output: Working ProfileForm component with validation, mobile-optimized numeric inputs, and store integration.
</objective>

<execution_context>
@/Users/zach/.claude/get-shit-done/workflows/execute-plan.md
@/Users/zach/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-ui-framework-components/16-RESEARCH.md

# Existing codebase patterns
@/Users/zach/localcode/openfinanceplanner/src/store/index.ts
@/Users/zach/localcode/openfinanceplanner/src/core/types/index.ts
@/Users/zach/localcode/openfinanceplanner/src/components/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ProfileForm component with validation</name>
  <files>src/components/forms/ProfileForm.tsx</files>
  <action>
    Create src/components/forms/ProfileForm.tsx:

    ```typescript
    import { useForm, isNotEmpty } from '@mantine/form';
    import { NumberInput, TextInput, Button, Stack, Paper, Text, Group } from '@mantine/core';
    import { useStore } from '@/store';
    import type { UserProfile } from '@/core/types';

    export function ProfileForm() {
      const setProfile = useStore((state) => state.setProfile);

      const form = useForm<{
        age: number | string;
        currentSavings: number | string;
        annualSpending: number | string;
        annualGrowthRate: number | string;
      }>({
        mode: 'uncontrolled',
        initialValues: {
          age: '',
          currentSavings: '',
          annualSpending: '',
          annualGrowthRate: 7,
        },
        validate: {
          age: (value) => {
            if (!value || value === '') return 'Age is required';
            const num = typeof value === 'string' ? parseFloat(value) : value;
            if (isNaN(num)) return 'Must be a valid number';
            if (num < 18) return 'Must be at least 18';
            if (num > 100) return 'Must be less than 100';
            return null;
          },
          currentSavings: (value) => {
            if (!value || value === '') return 'Savings is required';
            const num = typeof value === 'string' ? parseFloat(value) : value;
            if (isNaN(num) || num < 0) return 'Must be a positive number';
            return null;
          },
          annualSpending: (value) => {
            if (!value || value === '') return 'Annual spending is required';
            const num = typeof value === 'string' ? parseFloat(value) : value;
            if (isNaN(num) || num < 0) return 'Must be a positive number';
            return null;
          },
          annualGrowthRate: (value) => {
            const num = typeof value === 'string' ? parseFloat(value) : value;
            if (isNaN(num)) return 'Must be a valid number';
            if (num < 0) return 'Cannot be negative';
            if (num > 100) return 'Unrealistic growth rate';
            return null;
          },
        },
      });

      const handleSubmit = (values: typeof form.values) => {
        const profile: UserProfile = {
          age: Number(values.age),
          currentSavings: Number(values.currentSavings),
          annualSpending: Number(values.annualSpending),
          annualGrowthRate: Number(values.annualGrowthRate),
        };
        setProfile(profile);
      };

      return (
        <Paper shadow="xs" p="md" withBorder>
          <Stack gap="md">
            <Text size="lg" fw={500}>Enter Your Financial Profile</Text>

            <NumberInput
              label="Age"
              placeholder="Your age"
              min={18}
              max={100}
              withAsterisk
              key={form.key('age')}
              {...form.getInputProps('age')}
            />

            <NumberInput
              label="Current Savings"
              placeholder="100000"
              min={0}
              thousandSeparator=","
              prefix="$ "
              withAsterisk
              key={form.key('currentSavings')}
              {...form.getInputProps('currentSavings')}
            />

            <NumberInput
              label="Annual Spending"
              placeholder="50000"
              min={0}
              thousandSeparator=","
              prefix="$ "
              withAsterisk
              key={form.key('annualSpending')}
              {...form.getInputProps('annualSpending')}
            />

            <NumberInput
              label="Annual Growth Rate"
              placeholder="7"
              min={0}
              max={100}
              suffix="%"
              decimalScale={2}
              key={form.key('annualGrowthRate')}
              {...form.getInputProps('annualGrowthRate')}
            />

            <Group justify="flex-end">
              <Button type="submit" onClick={() => form.onSubmit(handleSubmit)()}>
                Save Profile
              </Button>
            </Group>
          </Stack>
        </Paper>
      );
    }
    ```

    NOTES per RESEARCH.md:
    - Use @mantine/form useForm with mode: 'uncontrolled' (v8 pattern)
    - Use form.getInputProps() for automatic value/onChange/error handling
    - Use NumberInput with thousandSeparator and prefix/suffix for formatting
    - Validation covers range checks (age 18-100, positive values for money, growth rate 0-100)

    KNOWN LIMITATION: Mantine NumberInput doesn't support inputMode="numeric" (RESEARCH.md Pitfall 3, GitHub issue #4821). Accept standard keyboard behavior for now - document in summary.
  </action>
  <verify>cat src/components/forms/ProfileForm.tsx | grep -q "ProfileForm"</verify>
  <done>ProfileForm component exists with form validation using @mantine/form</done>
</task>

<task type="auto">
  <name>Task 2: Create forms barrel export and update components index</name>
  <files>src/components/forms/index.ts, src/components/index.ts</files>
  <action>
    1. Create src/components/forms/index.ts:
       ```typescript
       export { ProfileForm } from './ProfileForm';
       ```

    2. Update src/components/index.ts:
       ```typescript
       /**
        * React UI components for the Open Finance Planner.
        */

       export * from './forms';
       ```

    This maintains the namespace export pattern established in Phase 13-04.
  </action>
  <verify>cat src/components/forms/index.ts | grep -q "ProfileForm"</verify>
  <done>Forms components exported via barrel files, accessible from @/components</done>
</task>

<task type="auto">
  <name>Task 3: Integrate ProfileForm into App.tsx</name>
  <files>src/App.tsx</files>
  <action>
    Update src/App.tsx to include ProfileForm:

    ```typescript
    import '@mantine/core/styles.css';
    import { MantineProvider, Container, Stack, Title, Text } from '@mantine/core';
    import { ProfileForm } from './components/forms';

    function App() {
      return (
        <MantineProvider defaultColorScheme="light">
          <Container size={{ base: 'xs', sm: 'md', md: 'lg' }} p={{ base: 'sm', md: 'xl' }}>
            <Stack gap="xl">
              <Stack gap="xs">
                <Title order={1}>Open Finance Planner</Title>
                <Text c="dimmed">
                  Privacy-first financial projections. Your data stays on your device.
                </Text>
              </Stack>

              <ProfileForm />
            </Stack>
          </Container>
        </MantineProvider>
      );
    }

    export default App;
    ```

    Use responsive spacing (gap={{ base: 'sm', md: 'xl' }}) per RESEARCH.md Pattern 2.
  </action>
  <verify>grep -q "ProfileForm" src/App.tsx</verify>
  <done>ProfileForm rendered in App with responsive layout spacing</done>
</task>

</tasks>

<verification>
1. Run `npm run dev` - development server starts
2. Visit http://localhost:5173 - ProfileForm renders with all fields visible
3. Test validation:
   - Submit with empty age - error "Age is required" appears
   - Enter age < 18 - error "Must be at least 18"
   - Enter age > 100 - error "Must be less than 100"
   - Enter negative values for savings/spending - validation error
   - Enter growth rate > 100 - "Unrealistic growth rate" error
4. Test valid submission - form accepts values, no errors shown
5. Open browser DevTools Console - no React warnings or errors
6. Run `npm run type-check` - TypeScript compilation succeeds
</verification>

<success_criteria>
1. ProfileForm component with 4 input fields (age, savings, spending, growth rate)
2. Form validation rules cover empty values, number ranges, and realistic limits
3. NumberInput components use formatting (thousandSeparator, prefix, suffix)
4. Form integrates with Zustand store via setProfile action
5. Component exported via barrel files for clean imports
6. Responsive layout using Mantine spacing object syntax
7. No TypeScript or runtime errors
</success_criteria>

<output>
After completion, create `.planning/phases/16-ui-framework-components/16-02-SUMMARY.md`
</output>
