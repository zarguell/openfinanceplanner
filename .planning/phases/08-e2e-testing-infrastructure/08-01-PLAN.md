---
phase: 08-e2e-testing-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [package.json, package-lock.json, vitest.config.js]
autonomous: true
must_haves:
  truths:
    - Developer can run `npm run test:e2e` and see one smoke test pass in browser
    - Vitest config includes E2E project with Playwright provider configured
    - Playwright browsers are installed and available for testing
    - `npm run test:e2e:ui` launches interactive test debugging UI
  artifacts:
    - path: "package.json"
      provides: "E2E testing dependencies"
      contains: "@vitest/browser-playwright"
    - path: "vitest.config.js"
      provides: "E2E project configuration"
      contains: "browser: { enabled: true }"
    - path: "tests/e2e/smoke.test.js"
      provides: "Basic smoke test"
      contains: "test('should create a plan',"
  key_links:
    - from: "package.json"
      to: "npm run test:e2e"
      via: "scripts configuration"
      pattern: "test:e2e.*vitest.*run.*--browser"
    - from: "vitest.config.js"
      to: "E2E project configuration"
      via: "projects configuration"
      pattern: "projects.*name.*e2e"
---

<objective>
Install and configure Vitest Browser Mode with Playwright provider to enable browser-based end-to-end testing.

Purpose: Establish the foundation for E2E testing by installing required dependencies, configuring Vitest for browser testing, and creating basic test scripts. This enables browser automation testing that validates the application works end-to-end from UI to localStorage.
Output: Working E2E test environment with one smoke test passing
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-e2e-testing-infrastructure/08-CONTEXT.md
@.planning/phases/08-e2e-testing-infrastructure/08-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Vitest Browser Mode and Playwright dependencies</name>
  <files>package.json, package-lock.json</files>
  <action>
    Install the required dependencies for E2E testing with Vitest Browser Mode:
    
    1. Add `@vitest/browser-playwright` as a dev dependency (this provides Vitest Browser Mode with Playwright provider)
    2. Add `playwright` as a dev dependency (this provides the Playwright automation library)
    
    Use npm to install these packages with exact versions that are compatible with the existing Vitest setup:
    - Use the same major version of Vitest (4.x) for compatibility
    - Install Playwright version that works with Vitest Browser Mode
    
    Update package.json devDependencies section to include these packages, then run npm install to update package-lock.json.
    
    Note: Playwright will automatically download the required browsers (chromium, firefox, webkit) on first run, but we'll focus on chromium as per CONTEXT.md decisions.
  </action>
  <verify>
    npm install completes successfully with no errors
    package.json contains @vitest/browser-playwright and playwright in devDependencies
    package-lock.json is updated with new dependencies
  </verify>
  <done>
    Dependencies installed successfully and package files updated
    Both @vitest/browser-playwright and playwright listed in devDependencies
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Vitest for Browser Testing</name>
  <files>vitest.config.js</files>
  <action>
    Update vitest.config.js to include E2E project configuration for browser testing:
    
    1. Add browser configuration to enable Vitest Browser Mode
    2. Configure the E2E project with Playwright provider
    3. Set up proper file patterns for E2E tests
    4. Configure browser options (headless mode, browser type)
    
    The configuration should:
    - Enable browser mode with Playwright provider
    - Define an E2E project that runs in the browser environment
    - Include appropriate test file patterns (e.g., tests/e2e/**/*.test.js)
    - Configure browser options to use chromium in headless mode by default
    - Set up proper isolation between tests
    
    Follow the Vitest Browser Mode documentation for proper configuration structure.
    
    Example structure:
    ```javascript
    export default defineConfig({
      test: {
        // existing unit test config
      },
      projects: [
        {
          name: 'e2e',
          browser: {
            enabled: true,
            provider: 'playwright',
            headless: true,
            // Only chromium as per CONTEXT.md
            name: 'chromium'
          },
          include: ['tests/e2e/**/*.test.js'],
          // E2E tests run in browser environment
          environment: 'browser'
        }
      ]
    });
    ```
  </action>
  <verify>
    vitest.config.js contains projects configuration with E2E browser project
    Configuration includes Playwright provider and chromium browser
    File patterns are set to include tests/e2e/**/*.test.js
  </verify>
  <done>
    Vitest configuration updated with E2E project using Playwright provider
    Browser mode enabled with chromium as the browser
    E2E test file patterns configured correctly
  </done>
</task>

</tasks>

<verification>
1. All dependencies installed without errors
2. Vitest config properly configured for browser testing
3. E2E project defined with Playwright provider
4. Browser set to chromium as specified in CONTEXT.md
</verification>

<success_criteria>

1. Developer can run `npm run test:e2e` and see one smoke test pass in browser
2. Vitest config includes E2E project with Playwright provider configured
3. Playwright browsers installed (chromium, firefox, webkit)
4. Smoke test creates a plan via browser automation and verifies it exists
5. `npm run test:e2e:ui` launches interactive test debugging UI
   </success_criteria>

<output>
After completion, create `.planning/phases/08-e2e-testing-infrastructure/08-01-SUMMARY.md`
</output>
