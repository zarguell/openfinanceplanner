---
phase: 08-e2e-testing-infrastructure
plan: 02
type: execute
wave: 2
depends_on: [08-01]
files_modified: [package.json, tests/e2e/smoke.test.js, tests/e2e/pages/AppPage.js]
autonomous: true
must_haves:
  truths:
    - Developer can run `npm run test:e2e` and see one smoke test pass in browser
    - Smoke test creates a plan via browser automation and verifies it exists
    - Playwright browsers are installed and available for testing
  artifacts:
    - path: 'tests/e2e/smoke.test.js'
      provides: 'Basic smoke test'
      contains: "test('should create a plan'"
    - path: 'tests/e2e/pages/AppPage.js'
      provides: 'Basic page object for app interactions'
      contains: 'class AppPage'
    - path: 'package.json'
      provides: 'E2E test scripts'
      contains: 'test:e2e'
  key_links:
    - from: 'package.json'
      to: 'npm run test:e2e'
      via: 'scripts configuration'
      pattern: 'test:e2e.*vitest.*run.*--browser'
    - from: 'tests/e2e/smoke.test.js'
      to: 'AppPage'
      via: 'import statement'
      pattern: 'import.*AppPage'
---

<objective>
Create E2E test scripts and implement a basic smoke test that validates the E2E testing infrastructure works correctly.

Purpose: Add npm scripts for running E2E tests and create a simple smoke test that proves the entire E2E pipeline works from browser automation to application functionality verification. This validates that developers can run browser-based tests and see them pass.
Output: Working E2E test scripts with one passing smoke test
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-e2e-testing-infrastructure/08-CONTEXT.md
@.planning/phases/08-e2e-testing-infrastructure/08-RESEARCH.md
@.planning/phases/08-e2e-testing-infrastructure/08-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add E2E Test Scripts to package.json</name>
  <files>package.json</files>
  <action>
    Add the required E2E test scripts to package.json as specified in requirement E2E-06:
    
    1. Add "test:e2e" script that runs E2E tests in headless mode
    2. Add "test:e2e:ui" script that launches the interactive test debugging UI
    3. Add "test:e2e:debug" script that runs tests in debug mode with browser visible
    
    The scripts should:
    - Use vitest with appropriate flags for browser testing
    - Specify the E2E project if multiple projects are configured
    - Use proper browser flags for headless vs headed modes
    
    Example script structure:
    ```json
    {
      "scripts": {
        "test:e2e": "vitest run --project e2e",
        "test:e2e:ui": "vitest --project e2e --ui",
        "test:e2e:debug": "vitest --project e2e --browser.headless false"
      }
    }
    ```
    
    Ensure the script names exactly match what's required in the roadmap success criteria.
  </action>
  <verify>
    package.json contains test:e2e, test:e2e:ui, and test:e2e:debug scripts
    Scripts use correct vitest commands with browser flags
    npm run test:e2e executes without errors (may fail if no tests exist yet)
  </verify>
  <done>
    All three E2E test scripts added to package.json
    Scripts follow the naming convention specified in requirements
    Commands are properly configured for Vitest Browser Mode
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Basic Smoke Test</name>
  <files>tests/e2e/smoke.test.js, tests/e2e/pages/AppPage.js</files>
  <action>
    Create a basic smoke test that validates the E2E testing infrastructure works:
    
    1. Create tests/e2e/smoke.test.js with a simple test that:
       - Creates a plan via browser automation
       - Verifies the plan exists in the plan list
       - Demonstrates the full pipeline: browser → app → localStorage → verification
    
    2. Create a basic AppPage class in tests/e2e/pages/AppPage.js that:
       - Provides methods for common app interactions
       - Uses resilient selectors (data-testid, ARIA roles) as per research findings
       - Encapsulates page logic to avoid test implementation details
    
    The smoke test should:
    - Use the Vitest Browser Mode test API
    - Interact with the application through the UI
    - Verify that data created through the UI is properly stored
    - Follow best practices from research (avoid testing implementation details)
    
    Example test structure:
    ```javascript
    import { test, expect } from 'vitest';
    import { AppPage } from './pages/AppPage.js';
    
    test('should create a plan via browser automation and verify it exists', async ({ page }) => {
      const appPage = new AppPage(page);
      const planName = 'Test Plan';
      
      // Create a plan through the UI
      await appPage.createPlan(planName);
      
      // Verify the plan exists in the list
      const planExists = await appPage.isPlanInList(planName);
      expect(planExists).toBe(true);
    });
    ```
    
    Example AppPage structure:
    ```javascript
    export class AppPage {
      constructor(page) {
        this.page = page;
      }
      
      async createPlan(name) {
        // Implementation to create a plan via UI
      }
      
      async isPlanInList(name) {
        // Implementation to check if plan exists in list
      }
    }
    ```
  </action>
  <verify>
    tests/e2e/smoke.test.js exists with at least one test
    tests/e2e/pages/AppPage.js exists with basic page object implementation
    Test uses browser automation to interact with the application
    Test verifies data persistence through UI interactions
  </verify>
  <done>
    Basic smoke test created that validates E2E infrastructure
    AppPage class provides basic page object functionality
    Test follows best practices for selector strategies
  </done>
</task>

</tasks>

<verification>
1. E2E test scripts added to package.json
2. Basic smoke test created that can run in browser
3. Page object pattern implemented for test maintainability
4. Test uses proper selectors and follows best practices
</verification>

<success_criteria>

1. Developer can run `npm run test:e2e` and see one smoke test pass in browser
2. Vitest config includes E2E project with Playwright provider configured
3. Playwright browsers installed (chromium, firefox, webkit)
4. Smoke test creates a plan via browser automation and verifies it exists
5. `npm run test:e2e:ui` launches interactive test debugging UI
   </success_criteria>

<output>
After completion, create `.planning/phases/08-e2e-testing-infrastructure/08-02-SUMMARY.md`
</output>
