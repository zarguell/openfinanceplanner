---
phase: 08-e2e-testing-infrastructure
plan: 02
type: execute
wave: 2
depends_on: [08-01]
files_modified: [package.json, tests/e2e/smoke.test.js, tests/e2e/pages/AppPage.js]
autonomous: true
must_haves:
  truths:
    - Developer can run `npm run test:e2e` and see one smoke test pass in browser
    - Developer can run `npm run test:e2e:ui` to launch interactive test debugging UI
    - Developer can run `npm run test:e2e:debug` to run tests in debug mode with browser visible
    - Smoke test creates a plan via browser automation and verifies it exists
    - E2E test scripts are properly configured in package.json
  artifacts:
    - path: 'package.json'
      provides: 'E2E test scripts'
      contains: 'test:e2e.*vitest.*run.*--project e2e'
    - path: 'tests/e2e/smoke.test.js'
      provides: 'Basic smoke test implementation'
      contains: 'new AppPage'
    - path: 'tests/e2e/pages/AppPage.js'
      provides: 'Basic page object for app interactions'
      contains: 'class AppPage'
  key_links:
    - from: 'package.json'
      to: 'npm run test:e2e'
      via: 'scripts configuration'
      pattern: 'test:e2e.*vitest.*run.*--project e2e'
    - from: 'tests/e2e/smoke.test.js'
      to: 'AppPage'
      via: 'import statement'
      pattern: 'import.*AppPage'
    - from: 'tests/e2e/smoke.test.js'
      to: 'localhost:3030'
      via: 'browser automation'
      pattern: "page\\.goto.*3030"
---

<objective>
Create E2E test scripts in package.json and implement a basic smoke test that creates a plan via browser automation and verifies it exists.

Purpose: Establish runnable E2E test scripts and a foundational smoke test that validates the complete end-to-end workflow from browser automation through UI interaction to data persistence. This enables developers to verify that the E2E testing infrastructure is properly configured and functional.
Output: Working E2E test scripts and a smoke test that passes in the browser
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-e2e-testing-infrastructure/08-CONTEXT.md
@.planning/phases/08-e2e-testing-infrastructure/08-RESEARCH.md
@.planning/phases/08-e2e-testing-infrastructure/08-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add E2E Test Scripts to package.json</name>
  <files>package.json</files>
  <action>
    Add the required E2E test scripts to package.json as specified in requirement E2E-06:
    
    1. Add "test:e2e" script that runs E2E tests in headless mode: `vitest run --project e2e`
    2. Add "test:e2e:ui" script that launches the interactive test debugging UI: `vitest --project e2e --ui`
    3. Add "test:e2e:debug" script that runs tests in debug mode with browser visible: `vitest --project e2e --browser.headless false`
    
    Place these scripts in the scripts section alongside the existing test scripts, maintaining proper JSON formatting.
    
    The scripts should:
    - Use the --project flag to specify the E2E project configured in vitest.config.js
    - Use proper browser flags for headless vs headed modes
    - Follow the exact naming conventions required by the roadmap success criteria
  </action>
  <verify>
    package.json contains test:e2e, test:e2e:ui, and test:e2e:debug scripts
    Scripts use correct vitest commands with --project flag
    npm run test:e2e executes without errors
    npm run test:e2e:ui launches the Vitest UI
    npm run test:e2e:debug executes without errors
  </verify>
  <done>
    All three E2E test scripts added to package.json
    Scripts follow the naming convention specified in requirements
    Commands are properly configured for Vitest Browser Mode with project flag
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement Smoke Test for Plan Creation</name>
  <files>tests/e2e/smoke.test.js, tests/e2e/pages/AppPage.js</files>
  <action>
    Implement the smoke test and AppPage class to validate the E2E testing infrastructure works:
    
    1. Update tests/e2e/smoke.test.js with a test that:
       - Creates a plan via browser automation using the AppPage class
       - Verifies the plan exists in the plan list
       - Demonstrates the full pipeline: browser → app → localStorage → verification
    
    2. Complete the AppPage class in tests/e2e/pages/AppPage.js that:
       - Provides methods for navigating to the app (goto)
       - Provides methods for creating plans (createPlan)
       - Provides methods for verifying plan existence (isPlanInList)
       - Uses resilient selectors (ARIA roles) as per research findings
    
    The smoke test should:
    - Use the Vitest Browser Mode test API with Playwright
    - Navigate to http://localhost:3030 where the app is served
    - Interact with the application through the UI using semantic selectors
    - Verify that data created through the UI is properly stored
    - Follow best practices from research (avoid testing implementation details)
    
    Implementation details:
    - Use page.getByRole() for reliable element selection
    - Use proper async/await patterns for asynchronous operations
    - Include error handling for element visibility checks
    - Use waitFor() methods to ensure elements are visible before asserting
  </action>
  <verify>
    tests/e2e/smoke.test.js contains a functional test implementation
    tests/e2e/pages/AppPage.js contains a complete page object implementation
    Test uses browser automation to interact with the application at http://localhost:3030
    Test verifies data persistence through UI interactions
    AppPage uses semantic selectors (getByRole) for element identification
  </verify>
  <done>
    Smoke test successfully creates a plan via browser automation
    AppPage class provides complete page object functionality
    Test follows best practices for selector strategies and error handling
    Implementation can be executed with npm run test:e2e when app is running
  </done>
</task>

</tasks>

<verification>
1. All E2E test scripts are properly configured in package.json
2. Smoke test implements actual browser automation for plan creation
3. Test uses semantic selectors for reliable element identification
4. Implementation follows Playwright best practices for test reliability
5. Package.json maintains proper formatting and structure
6. AppPage class encapsulates UI interactions for maintainability
</verification>

<success_criteria>

1. Developer can run `npm run test:e2e` and see one smoke test pass in browser
2. Vitest config includes E2E project with Playwright provider configured
3. Playwright browsers installed (chromium, firefox, webkit)
4. Smoke test creates a plan via browser automation and verifies it exists
5. `npm run test:e2e:ui` launches interactive test debugging UI
   </success_criteria>

<output>
After completion, create `.planning/phases/08-e2e-testing-infrastructure/08-02-SUMMARY.md`
</output>
