---
phase: 08-e2e-testing-infrastructure
plan: 03
type: execute
wave: 3
depends_on: [08-02]
files_modified: [.github/workflows/ci.yml, tests/e2e/smoke.test.js]
autonomous: false
must_haves:
  truths:
    - Developer can run `npm run test:e2e` and see one smoke test pass in browser
    - Smoke test creates a plan via browser automation and verifies it exists
    - GitHub Actions workflow runs E2E tests successfully
    - `npm run test:e2e:ui` launches interactive test debugging UI
  artifacts:
    - path: ".github/workflows/ci.yml"
      provides: "CI workflow for E2E tests"
      contains: "npm run test:e2e"
    - path: "tests/e2e/smoke.test.js"
      provides: "Working smoke test"
      contains: "test('should create a plan'"
  key_links:
    - from: ".github/workflows/ci.yml"
      to: "npm run test:e2e"
      via: "workflow steps"
      pattern: "run.*npm.*test:e2e"
    - from: "tests/e2e/smoke.test.js"
      to: "Application UI"
      via: "browser automation"
      pattern: "page.*click.*fill"
---

<objective>
Configure GitHub Actions workflow to run E2E tests and verify that the smoke test passes in CI environment.

Purpose: Ensure E2E tests run automatically in the CI/CD pipeline and validate that the testing infrastructure works in a GitHub Actions environment. This establishes trust that the E2E tests will catch regressions early.
Output: Working CI configuration with E2E tests passing in GitHub Actions
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-e2e-testing-infrastructure/08-CONTEXT.md
@.planning/phases/08-e2e-testing-infrastructure/08-RESEARCH.md
@.planning/phases/08-e2e-testing-infrastructure/08-01-SUMMARY.md
@.planning/phases/08-e2e-testing-infrastructure/08-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update GitHub Actions Workflow for E2E Tests</name>
  <files>.github/workflows/ci.yml</files>
  <action>
    Update the existing GitHub Actions CI workflow to include E2E tests:
    
    1. Add a step to run E2E tests after the existing lint and unit test steps
    2. Ensure Playwright browsers are properly installed in the CI environment
    3. Configure appropriate environment for browser testing in CI
    
    The workflow should:
    - Use the same Node.js version as existing steps
    - Install dependencies including the new E2E testing packages
    - Run E2E tests using the npm run test:e2e script
    - Handle any CI-specific configuration needed for browser testing
    
    Considerations for CI environment:
    - Playwright requires additional dependencies in some CI environments
    - May need to configure xvfb or similar for headless browser testing
    - Ensure adequate timeout settings for browser-based tests
    - Consider caching strategies for faster workflow execution
    
    Follow Playwright's GitHub Actions documentation for proper CI setup.
    The existing workflow already runs on pull requests and pushes to main.
  </action>
  <verify>
    .github/workflows/ci.yml includes steps to run E2E tests
    Workflow uses npm run test:e2e command
    Playwright browsers properly installed in CI environment
    Workflow runs successfully when executed
  </verify>
  <done>
    GitHub Actions workflow updated to run E2E tests
    Playwright browsers properly configured for CI
    Workflow executes E2E tests as part of CI process
  </done>
</task>

<task type="checkpoint:human-verify">
  <name>Task 2: Verify E2E Testing Infrastructure Works</name>
  <what-built>
    Complete E2E testing infrastructure including:
    1. Installed Vitest Browser Mode with Playwright provider
    2. Configured Vitest for browser testing with E2E project
    3. Added E2E test scripts (test:e2e, test:e2e:ui, test:e2e:debug)
    4. Created basic smoke test that creates a plan via browser automation
    5. Updated GitHub Actions workflow to run E2E tests in CI
  </what-built>
  <how-to-verify>
    1. Run `npm run test:e2e` and verify the smoke test passes in headless browser
    2. Run `npm run test:e2e:ui` and verify the interactive UI launches correctly
    3. Run `npm run test:e2e:debug` and verify tests run with browser visible
    4. Check that vitest.config.js includes E2E project with Playwright provider
    5. Verify that tests/e2e/smoke.test.js creates a plan and verifies it exists
    6. Check that .github/workflows/ci.yml includes E2E test execution
    7. Confirm all requirements from ROADMAP.md are met:
       - E2E-01: Install Vitest Browser Mode with Playwright provider ✓
       - E2E-02: Configure E2E test environment (vitest.config.js, playwright config) ✓
       - E2E-06: Add test scripts (test:e2e, test:e2e:ui, test:e2e:debug) ✓
  </how-to-verify>
  <resume-signal>
    Type "approved" or describe any issues that need to be addressed
  </resume-signal>
</task>

</tasks>

<verification>
1. GitHub Actions workflow updated to run E2E tests
2. All E2E test scripts functional
3. Smoke test passes in both local and CI environments
4. All requirements from roadmap satisfied
</verification>

<success_criteria>

1. Developer can run `npm run test:e2e` and see one smoke test pass in browser
2. Vitest config includes E2E project with Playwright provider configured
3. Playwright browsers installed (chromium, firefox, webkit)
4. Smoke test creates a plan via browser automation and verifies it exists
5. `npm run test:e2e:ui` launches interactive test debugging UI
   </success_criteria>

<output>
After completion, create `.planning/phases/08-e2e-testing-infrastructure/08-03-SUMMARY.md`
</output>
