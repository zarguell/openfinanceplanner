---
phase: 07-critical-bug-fixes
plan: 03
type: execute
wave: 3
depends_on:
  - 07-02
files_modified: []
autonomous: false

must_haves:
  truths:
    - 'User can create a new plan and see it in plan list'
    - 'User can add an account and see it in accounts list'
    - 'User can run projection and see results table render'
    - 'Monte Carlo analysis section displays (success probability, percentiles)'
    - 'All 4 charts render (balance, Monte Carlo fan, allocation, cash flow)'
    - 'Settings/Import/Export workflows complete without errors'
  artifacts: []
  key_links:
    - from: 'User UI interactions'
      to: 'localStorage'
      via: 'Storage.savePlan'
      pattern: "localStorage\\.setItem"
    - from: 'User UI interactions'
      to: 'ProjectionController.runProjection'
      via: 'onclick handler'
      pattern: "runProjection\\(\\)"
    - from: 'ProjectionController'
      to: 'src/calculations/monte-carlo.js'
      via: 'runMonteCarloSimulation call'
      pattern: "runMonteCarloSimulation\\("
---

<objective>
Verify all critical user workflows work end-to-end without errors, confirming the bug fixes deliver fully functional application.

Purpose: After BUGFIX-01/02/03 are fixed, validate the entire application works as intended by testing all major user workflows. This ensures no hidden issues remain.

Output: All 5 workflows verified (create plan, add account, run projection, settings, import/export), zero console errors throughout, Monte Carlo results render correctly.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/07-critical-bug-fixes/07-01-SUMMARY.md
@.planning/phases/07-critical-bug-fixes/07-02-SUMMARY.md
@.planning/phases/07-critical-bug-fixes/07-RESEARCH.md

# Workflows to verify (from RESEARCH.md)

# 1. Create Plan → 2. Add Account → 3. Run Projection → 4. Settings → 5. Import/Export

</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Application is now functional (window.app initialized, zero console errors). Requires human testing of 5 critical workflows to confirm end-to-end functionality.
  </what-built>
  <how-to-verify>
    **Prerequisite:** Dev server running at http://localhost:3030, Chrome DevTools Console open

    **Workflow 1: Create Plan**
    1. Click "+ New Plan" button
    2. Enter: Name="Test Plan", Current Age=40, Retirement Age=67
    3. Click "Create" button
    4. Verify: Plan appears in plan list sidebar
    5. Check console: Zero errors

    **Workflow 2: Add Account**
    1. Select "Test Plan" from plan list
    2. Navigate to Accounts section
    3. Click "Add Account" button
    4. Enter: Type="401k", Name="Employer 401k", Balance=100000, Contribution=10000
    5. Click "Save" button
    6. Verify: Account appears in accounts list
    7. Check console: Zero errors

    **Workflow 3: Run Projection**
    1. Click "Run Projection" button (top of page)
    2. Wait for results to render (1-2 seconds)
    3. Verify results table displays year-by-year data
    4. Verify Monte Carlo analysis section appears:
       - Success probability badge (e.g., "85%")
       - Percentiles (10th, 25th, 50th, 75th, 90th)
       - Analysis text
    5. Verify all 4 charts render:
       - Balance projection chart (line chart)
       - Monte Carlo fan chart (spaghetti plot)
       - Allocation chart (pie or bar)
       - Cash flow chart (bar chart)
    6. Check console: Zero errors

    **Workflow 4: Settings**
    1. Click "Settings" button (header)
    2. Modify an assumption (e.g., Equity Growth Rate from 7% to 8%)
    3. Click "Save" button
    4. Verify: Settings modal closes, plan updated
    5. Check console: Zero errors

    **Workflow 5: Import/Export**
    1. Click "Export" button (sidebar)
    2. Verify: Plan JSON downloads or copies to clipboard
    3. Delete "Test Plan" (click plan, click "Delete" in header, confirm)
    4. Click "Import" button (sidebar)
    5. Paste exported JSON
    6. Click "Import" button
    7. Verify: "Test Plan" reappears in plan list
    8. Check console: Zero errors

    **Final Verification:**
    - Monte Carlo results look reasonable (not all zero, not NaN values)
    - All UI elements render correctly (no broken layout)
    - Console stays clean throughout all workflows

  </how-to-verify>
  <resume-signal>Type "approved" if all 5 workflows complete with zero console errors and all UI elements render correctly. Describe any issues.</resume-signal>
</task>

</tasks>

<verification>
- All 5 workflows complete without console errors
- Monte Carlo analysis displays (success probability, percentiles, analysis text)
- All 4 charts render (balance, Monte Carlo fan, allocation, cash flow)
- Plan appears in list after creation
- Account appears in list after adding
- Export/Import preserves plan data
- Settings changes persist
</verification>

<success_criteria>

1. User can create plan → appears in list, no errors
2. User can add account → appears in accounts list, no errors
3. User can run projection → results table + Monte Carlo section + 4 charts render, no errors
4. User can modify settings → changes persist, no errors
5. User can export/import → plan data preserved, no errors
6. Monte Carlo results display non-zero, non-NaN values
   </success_criteria>

<output>
After completion, create `.planning/phases/07-critical-bug-fixes/07-03-SUMMARY.md`
</output>
