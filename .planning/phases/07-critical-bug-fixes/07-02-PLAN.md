---
phase: 07-critical-bug-fixes
plan: 02
type: execute
wave: 2
depends_on:
  - 07-01
files_modified: []
autonomous: false

must_haves:
  truths:
    - 'Application loads without module import errors in console'
    - "window.app object is initialized (typeof === 'object')"
    - "All 9 HTML onclick handlers work without 'app is not defined' errors"
    - 'Zero console errors during page load and button clicks'
  artifacts: []
  key_links:
    - from: 'index.html'
      to: 'src/ui/AppController.js'
      via: 'module script initialization'
      pattern: "window\\.app\\s*=\\s*new\\s+AppController"
    - from: 'index.html'
      to: 'window.app'
      via: 'onclick handlers'
      pattern: "onclick=\"app\\."
---

<objective>
Verify that restoring Monte Carlo implementation fixes the module loading cascade, allowing window.app to initialize and all onclick handlers to work.

Purpose: BUGFIX-02 and BUGFIX-03 are blocked by BUGFIX-01. After Monte Carlo is restored, verify the module chain loads correctly, window.app exists, and all console errors are resolved.

Output: window.app initialized, all onclick handlers functional, zero console errors (except harmless favicon.ico 404).
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/07-critical-bug-fixes/07-01-SUMMARY.md
@.planning/phases/07-critical-bug-fixes/07-RESEARCH.md

# HTML onclick handlers affected (9 total)

# - onclick="app.showNewPlanModal()" onclick="app.showImportModal()" onclick="app.exportCurrentPlan()"

# - onclick="app.showPlanSettingsModal()" onclick="app.deletePlan()"

# - onclick="app.closeModal('newPlanModal')" onclick="app.createNewPlan()"

# - onclick="app.closeModal('importModal')" onclick="app.importPlan()"

# - onclick="app.closeModal('planSettingsModal')" onclick="app.savePlanSettings()"

</context>

<tasks>

<task type="auto">
  <name>Start Development Server and Verify Module Loading</name>
  <files></files>
  <action>
    1. Start dev server: `npm run serve` (starts http.server on port 3030)
    2. Open browser to http://localhost:3030
    3. Open Chrome DevTools (F12 → Console tab)
    4. Check console for module import errors (should be zero, only favicon.ico 404 warning)
    5. In DevTools console, verify: `typeof window.app` (should be 'object')
    6. Check app methods exist: `Object.getOwnPropertyNames(window.app)` (should include showNewPlanModal, showImportModal, exportCurrentPlan, showPlanSettingsModal, deletePlan, closeModal, createNewPlan, importPlan, savePlanSettings)
  </action>
  <verify>
    1. `typeof window.app === 'object'` → true
    2. Console shows zero module import errors
    3. `window.app.showNewPlanModal` → function (not undefined)
  </verify>
  <done>
    Application loads without module errors, window.app is initialized, app methods are available.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Automated verification completed: window.app initialized, no module errors. Now requires human testing of all onclick handlers to confirm no "app is not defined" errors.
  </what-built>
  <how-to-verify>
    1. Ensure dev server is running: http://localhost:3030
    2. Open Chrome DevTools (F12 → Console tab)
    3. Clear console
    4. Test each onclick handler by clicking buttons in UI:

       **Sidebar buttons:**
       - Click "+ New Plan" button (modal should open, no console error)
       - Click "Import" button (modal should open, no console error)
       - Click "Export" button (export should trigger, no console error)

       **Header buttons (select a plan first):**
       - Click "Settings" button (modal should open, no console error)
       - Click "Delete" button (confirmation should appear, no console error)

       **Modal cancel buttons:**
       - Click "+ New Plan" to open modal
       - Click "Cancel" button (modal should close, no console error)
       - Click "Import" to open modal
       - Click "Cancel" button (modal should close, no console error)
       - Click "Settings" to open modal
       - Click "Cancel" button (modal should close, no console error)

    5. After testing all handlers, verify console has zero errors (only acceptable warning: favicon.ico 404)

  </how-to-verify>
  <resume-signal>Type "approved" if all onclick handlers work with zero console errors. If any errors, describe the issue.</resume-signal>
</task>

</tasks>

<verification>
- window.app is initialized (typeof === 'object')
- All 9 onclick handlers work without "app is not defined" errors
- Console shows zero errors on page load (only favicon.ico 404 warning)
- All app methods are available (verified with Object.getOwnPropertyNames)
</verification>

<success_criteria>

1. `typeof window.app === 'object'` in DevTools console
2. All 9 HTML onclick handlers functional (test by clicking each button)
3. Zero console errors (except harmless favicon.ico 404)
4. All app methods accessible via window.app
   </success_criteria>

<output>
After completion, create `.planning/phases/07-critical-bug-fixes/07-02-SUMMARY.md`
</output>
