---
phase: 18-pwa-offline-capability
plan: '01'
type: execute
wave: 1
depends_on: []
files_modified:
  [
    'vite.config.ts',
    'public/favicon.svg',
    'public/pwa-192x192.png',
    'public/pwa-512x512.png',
  ]
autonomous: true
user_setup: []
must_haves:
  truths:
    - 'Vite configuration includes PWA plugin with proper manifest settings'
    - 'Application has a web app manifest with name, icons, and theme colors'
    - 'Build process generates service worker and manifest files'
  artifacts:
    - path: 'vite.config.ts'
      provides: 'VitePWA plugin configuration'
      contains: 'VitePWA('
    - path: 'public/manifest.webmanifest'
      provides: 'Web app manifest file'
      contains: 'name'
  key_links:
    - from: 'vite.config.ts'
      to: 'VitePWA'
      via: 'plugins array'
      pattern: "plugins: \\[.*VitePWA\\("
---

<objective>
Configure vite-plugin-pwa with manifest and service worker settings

Purpose: Enable basic PWA functionality with app manifest and service worker generation
Output: Configured Vite build with PWA plugin that generates manifest and service worker
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-pwa-offline-capability/18-CONTEXT.md
@.planning/phases/18-pwa-offline-capability/18-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure vite-plugin-pwa in Vite config</name>
  <files>vite.config.ts</files>
  <action>Update the Vite configuration to include the VitePWA plugin with the following settings:
- registerType: 'autoUpdate' for seamless updates
- includeAssets: ['favicon.svg', 'robots.txt'] (if robots.txt exists)
- manifest configuration with:
  * name: 'Open Finance Planner'
  * short_name: 'FinancePlanner'
  * description: 'Privacy-first financial projections. Your data stays on your device.'
  * theme_color: '#339af0' (matching Mantine primary blue)
  * background_color: '#ffffff'
  * display: 'standalone'
  * icon entries for 192x192 and 512x512 sizes
- workbox configuration with:
  * globPatterns: ['**/*.{js,css,html,ico,png,svg,woff2}'] for asset caching
  * skipWaiting: true for immediate activation of new service workers
  * clientsClaim: true for taking control of clients immediately
  
Use the existing alias configuration and maintain compatibility with React and TypeScript.</action>
  <verify>npx vite build && ls -la dist/ | grep -E "(manifest|sw)"</verify>
  <done>Vite config includes VitePWA plugin, build generates manifest.webmanifest and sw.js files</done>
</task>

<task type="auto">
  <name>Task 2: Create PWA icons and assets</name>
  <files>public/favicon.svg, public/pwa-192x192.png, public/pwa-512x512.png</files>
  <action>Create the required PWA assets in the public directory:
1. Copy the existing favicon.svg to be used as the source for PWA icons
2. Generate pwa-192x192.png and pwa-512x512.png from favicon.svg (or create simple placeholder icons if favicon is not suitable)
3. Ensure icons are in proper PNG format with transparent backgrounds where appropriate
4. Add robots.txt file to public directory with basic content:
   User-agent: *
   Disallow:</action>
  <verify>ls -la public/ && npx vite build && ls -la dist/ | grep -E "\.(png|svg)$"</verify>
  <done>Required PWA assets exist in public directory and are copied to dist during build</done>
</task>

</tasks>

<verification>
- Vite config includes VitePWA plugin with manifest and workbox settings
- PWA assets (icons, favicon) exist in public directory
- Build process generates manifest.webmanifest and sw.js files
- Manifest includes proper app name, icons, and theme settings
</verification>

<success_criteria>

- Vite build completes successfully with PWA plugin
- Generated manifest.webmanifest file contains correct app information
- Service worker file (sw.js) is generated in dist directory
- PWA icons are included in the build output
  </success_criteria>

<output>
After completion, create `.planning/phases/18-pwa-offline-capability/18-01-SUMMARY.md`
</output>
</file>
